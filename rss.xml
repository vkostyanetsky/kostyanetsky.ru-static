<rss version="2.0">
    <channel>    
        <title>Влад Костянецкий</title>
        <description>Привет! Меня зовут Влад, я — разработчик приложений для бизнеса.</description>
        <language>ru</language>
        <link>https://kostyanetsky.ru</link>
        <lastBuildDate>Mon, 21 Mar 2022 20:25:48 +0700</lastBuildDate>
        
        <item>
            <title>Минус встроенные твиты</title>
            <link>https://kostyanetsky.ru/notes/no-more-embedded-tweets/</link>
            <guid isPermaLink="false">note-no-more-embedded-tweets</guid>
            <pubDate>Mon, 21 Mar 2022 20:25:48 +0700</pubDate>
            <description><p class="measure-wide">Не успел я <a class="link blue dim bb" href="https://kostyanetsky.ru/notes/no-more-google-fonts/" target="_blank">выпилить</a> из блога Google Fonts, как пришлось отправить вдогонку встроенные твиты.</p>
<p class="measure-wide">Как это работало раньше? Хотел сослаться на твит — просто вставлял на него ссылку. Скрипт сборки заменял её на HTML-блок, который находил скрипт Твиттера и заменял на текст твита (и всякими полезными ссылками). Вот в этом <a class="link blue dim bb" href="https://github.com/vkostyanetsky/BlogBuilder/commit/c21ef8a7bec10672406e6be57b8e734ba3ac01c5" target="_blank">коммите</a> в целом видно, как это работало.</p>
<p class="measure-wide">Как это работает теперь? Ну да, никак. Твиттер в России заблокирован, так что его скрипты работают только со включенным VPN.</p>
<p class="measure-wide"><img alt="Штош" src="https://kostyanetsky.ru/notes/no-more-embedded-tweets/well.jpg"/></p>
<p class="measure-wide">Пришлось поскринить все твиты, на которые я когда-то ссылался, и добавить их в заметки в виде картинок со ссылками. Кому нужен оригинал, тот включит VPN и перейдёт в Твиттер, а остальные, по крайней мере, могут прочитать текст.</p>
<p class="measure-wide">Пара слов про техническую сторону. Скринить каждый твит вручную мне было лень, поэтому я полез в сеть, обдумывая, как автоматизировать процесс. Сначала попадались только сервисы, готовые решить проблему за какие-то жалкие десять долларов (спасибо, как-нибудь в следующий раз), но потом я набрёл на идеальный <a class="link blue dim bb" href="https://github.com/privatenumber/snap-tweet" target="_blank">инструмент</a>: консольный скрипт для Node.js.</p>
<p class="measure-wide">Ничего лишнего. Чистый функционал. Ты ему — твит. Он тебе — картинку:</p>
<blockquote>
<p class="measure-wide">npx snap-tweet https://twitter.com/PossumEveryHour/status/1506148678461014016</p>
</blockquote>
<p class="measure-wide">И всё. Захотелось занести автору денег.</p>
<p class="measure-wide">Подумал, не прикрутить ли snap-tweet к скрипту сборки (чтобы было, как раньше: вставляешь ссылку на твит, а дальше оно само генерит картинку и кладёт куда надо). Решил, нафиг. Грубое попирание KISS, да и вообще... В мире и так хватает энтропии. Особенно, блин, сейчас.</p></description>
        </item>
        
        <item>
            <title>Смотри не перепутай</title>
            <link>https://kostyanetsky.ru/notes/do-not-confuse/</link>
            <guid isPermaLink="false">note-do-not-confuse</guid>
            <pubDate>Wed, 16 Mar 2022 20:09:31 +0700</pubDate>
            <description><p class="measure-wide"><img alt="Код" src="https://kostyanetsky.ru/notes/do-not-confuse/do-not-confuse.png"/></p>
<p class="measure-wide">Если вид операции — продажа товара или недвижимости, то открой общую форму AdvancesPickFormWithVAT с параметрами, описанными в структуре PickParameters. Колбеком будет метод EditPrepaymentOffsetEnd, описанный в этом же модуле; передай ему структуру AdditionalParameters. Форму нужно открыть так, чтобы она заблокировала весь интерфейс.</p>
<p class="measure-wide">А вот если вид операции — возврат поставщику, то открой общую форму AdvancesPickFormWithVAT с параметрами, описанными в структуре PickParameters. Колбеком будет метод EditPrepaymentOffsetEnd, описанный в этом же модуле; передай ему структуру AdditionalParameters. Форму нужно открыть так, чтобы она заблокировала весь интерфейс.</p>
<p class="measure-wide">Смотри не перепутай.</p></description>
        </item>
        
        <item>
            <title>Минус Google Fonts</title>
            <link>https://kostyanetsky.ru/notes/no-more-google-fonts/</link>
            <guid isPermaLink="false">note-no-more-google-fonts</guid>
            <pubDate>Sat, 19 Feb 2022 20:25:48 +0700</pubDate>
            <description><p class="measure-wide"><a href="https://twitter.com/PixelAmbacht/status/1494272370076536840" target="_blank"><img alt="Твит" src="https://kostyanetsky.ru/notes/no-more-google-fonts/snap-tweet-PixelAmbacht-1494272370076536840.png"/></a></p>
<p class="measure-wide">Год назад, блин. Ладно, всем привет! С вами Джонни Слоупок! Сегодня мы будем выпиливать из моего блога работу с Google Fonts. Я подгружал с него основной шрифт (PT Sans), но без кросс-доменного кэширования единственный смысл делать это дальше — если сервер, на котором работает сайт, слабоват и с гугла шрифты грузятся шустрее. </p>
<p class="measure-wide">В моем случае блог отдают сервера гитхаба, которые на производительность не жалуются, так что теперь PT Sans загружается прямо с них. И знаете что? Разница прямо драматическая. Если раньше при обновлении страницы была явно заметна задержка между загрузкой страницы и загрузкой шрифта, то теперь её невооруженным глазом не разобрать. Если у вас свой блог и хотите попробовать — вот тут есть классный <a class="link blue dim bb" href="https://google-webfonts-helper.herokuapp.com/fonts" target="_blank">сервис</a>, который решает задачу в несколько кликов.</p>
<p class="measure-wide">Не забудьте повесить звезду на <a class="link blue dim bb" href="https://github.com/majodev/google-webfonts-helper" target="_blank">репозиторий</a>!</p></description>
        </item>
        
        <item>
            <title>Итоги 2021-го</title>
            <link>https://kostyanetsky.ru/notes/totals-of-2021/</link>
            <guid isPermaLink="false">note-totals-of-2021</guid>
            <pubDate>Tue, 08 Feb 2022 13:25:00 +0700</pubDate>
            <description><p class="measure-wide">Поздновато я сел итоги подводить, да? Ну, предыдущие пара месяцев вышли, гм, плотными и у меня банально руки не доходили сесть и подумать. А сейчас я как раз в отпуске за 2021-й год — так что самое время. Пишу, типа, из прошлого.</p>
<p class="measure-wide">Выписывать каждую ачивку меня совершенно не тянет. Год точно вышел неплохим: я проделал уйму сложной работы над FirstBit ERP (писал новые модули, перепиливал существующие, давил баги, писал функциональные и нагрузочные тесты — да много чего было). Это хорошо сказалось и на самой конфе, и на делах компании. Кроме того, между делом я защитился на эксперта по 1С и на профессионала по PostgreSQL, гип-гип-ура.</p>
<p class="measure-wide">Были и фейлы, ну. Перечислять, опять же, лень, но главный провал — я чудовищно разжирел и вместо того, чтобы сбросить килограм десять (таков был изначальный план) — набрал ещё пяток.</p>
<p class="measure-wide">Оглядываясь назад, корень большинства проблем за прошлый год вижу так: я слишком сильно фокусировался на потоке задач. Они все были по-своему интересные, от тщательно проработанного ТЗ до челленджей в духе «найди в коде проблему, используя ведьмачье чутьё». Делаешь одну задачу, другую, третью, сотую и сам не замечаешь, что забил почти на всё, кроме работы. В итоге получаешь кучу опыта, но мир усыхает до окна с конфигуратором и сил как-то применять этот опыт нет. Нездоровая фигня.</p>
<p class="measure-wide">Короче, если представить меня как персонажа какой-нибудь видеоигры, выглядит так: атака и интеллект за год заметно выросли, но здоровье, подвижность, харизма и вообще почти всё остальное — поползло вниз. Теперь надо с этим всем что-то делать.</p>
<p class="measure-wide">Пойду для начала пробегусь километров десять, вот что!</p>
<p class="measure-wide"><a href="https://twitter.com/EffinBirds/status/1329575199667347459" target="_blank"><img alt="Твит" src="https://kostyanetsky.ru/notes/totals-of-2021/snap-tweet-EffinBirds-1329575199667347459.png"/></a></p>
<p class="measure-wide">Возможно, птичка, возможно.</p></description>
        </item>
        
        <item>
            <title>Переиспользуйте с осторожностью</title>
            <link>https://kostyanetsky.ru/notes/reuse-carefully/</link>
            <guid isPermaLink="false">note-reuse-carefully</guid>
            <pubDate>Tue, 08 Feb 2022 09:00:11 +0700</pubDate>
            <description><p class="measure-wide">Расскажу про смешной и немного стыдный кейс, который разбирал в январе. Суть в двух словах: где-то ближе к концу падает огромный автотест на Ванессе, проверяющий расчёт НДС.</p>
<p class="measure-wide">Начинаю расследовать. Первым делом смотрю на скрины в Аллюре: о'кей, причина очевидна — в одном из документов сдохло условное оформление для поля с суммой НДС. Тест ожидал, что оно будет недоступно, если ставка НДС равна нулю, а оно оказалось доступным.</p>
<p class="measure-wide">Непорядок, надо чинить. Смотрю на условие оформления в коде: ну, поле блокируется, если ссылка на ставку НДС есть в списке «нулевых» ставок (т.е. ставка в которых равна нулю). Всё просто и логично. Что тут, блин, могло сломаться?</p>
<p class="measure-wide"><a href="https://twitter.com/EffinBirds/status/1489980393675702281" target="_blank"><img alt="Твит" src="https://kostyanetsky.ru/notes/reuse-carefully/snap-tweet-EffinBirds-1489980393675702281.png"/></a></p>
<p class="measure-wide">Ладно, лезу в документ ручками. А там внезапно всё тип-топ: оформление работает как надо. Плавающий баг, что ли? Запускаю автотест снова, в нужный момент вклиниваюсь с отладчиком и обнаруживаю какую-то откровенную фигню: в списке «нулевых» ставок, кроме них самих — пачка пустых ссылок! </p>
<p class="measure-wide">Откровенно чешу в затылке. Этот список документ получает из общего модуля, где лежит <a class="link blue dim bb" href="https://gist.github.com/vkostyanetsky/5ec036ee148606aad9caefbc9305bfb0" target="_blank">примерно такой код</a>. Пустую ссылку отсюда даже теоретически получить нельзя. Причем у модуля включено переиспользование возвращаемых значений и функция по факту выполняется один раз где-то в начале теста, до всех сложных манипуляций с данными. То есть тест, по идее, повлиять на неё никак не может.</p>
<p class="measure-wide">Тупик? Ну, опытные коллеги уже, наверное, обо всём догадались, но мне пришлось порядком потанцевать вокруг бага и даже залезть в <a class="link blue dim bb" href="https://its.1c.ru/db/v8std/content/724/hdoc" target="_blank">стандарт</a>, пока не дошло: <strong>кэш возвращаемых значений в 1С можно изменить</strong>. В смысле, не просто вызвать ОбновитьПовторноИспользуемыеЗначения(), а прямо вот ручками взять и поменять конкретные данные.</p>
<p class="measure-wide">Как? Ну, если вы тянете из общего модуля со включенным кэшированием какие-то значения и они не примитивного типа (строка, число и т.п.) — вы получите не само значение, а указатель на него где-то в памяти. Запишете этот указатель в переменную и попробуете поменять — поменяете кэш.</p>
<p class="measure-wide">Вот так просто, да. Это и произошло в моем случае: метод, формирующий список «нулевых» ставок, вызывала форма другого документа. Получив список значений, она непринужденно дописывала к нему пустую ссылку и использовала в своей логике. Таким образом, при каждом открытии этой формы кэш списка прирастал всё новыми и новыми пустыми ссылками, что в конце концов сломало документ на другом конце конфы.</p>
<p class="measure-wide"><a href="https://twitter.com/EffinBirds/status/1488165946342662144" target="_blank"><img alt="Твит" src="https://kostyanetsky.ru/notes/reuse-carefully/snap-tweet-EffinBirds-1488165946342662144.png"/></a></p>
<p class="measure-wide">По-хорошему, платформе стоило бы швыряться исключениями при попытке поменять кэш, но пока этого не происходит — надо бить себя по рукам самостоятельно. Например, при разработке кэшируемых модулей возвращать из них неизменяемые типы данных (ФиксированнаяСтруктура вместо Структура, ФиксированныйМассив вместо Массив и так далее). Это, правда, не стопроцентная защита: во-первых, фиксированные типы не везде применимы, а во-вторых — даже в последних версиях БСП это делается далеко не везде. Много конфигураций сейчас пишется не на БСП?</p>
<p class="measure-wide">Сонар тоже пока не умеет ловить проблему, а про менее популярные средства я вообще молчу. Никакой серебрянной пули, короче — следим за своим кодом, поглядываем в код коллег и стараемся не забывать об ещё одном изящном способе бахнуть себе в ногу.</p></description>
        </item>
        
        <item>
            <title>Infostart Event 2021</title>
            <link>https://kostyanetsky.ru/notes/infostart-event-2021/</link>
            <guid isPermaLink="false">note-infostart-event-2021</guid>
            <pubDate>Tue, 16 Nov 2021 23:40:48 +0700</pubDate>
            <description><p class="measure-wide">На прошлой неделе сгонял в Москву на <a class="link blue dim bb" href="https://event.infostart.ru/2021_msk/" target="_blank">Infostart Event 2021</a>:</p>
<ul class="measure-wide">
<li>Послушать дюжину докладов о разработке и близких темах — check;</li>
<li>Развиртуализоваться с несколькими классными людьми — check;</li>
<li>Поболтать с друзьями — check!</li>
</ul>
<p class="measure-wide">По итогу неожиданно почуствовал себя отдохнувшим — и это несмотря на перелёты, нервы и суету. Думаю, дело в том, что я удалёнщик; было по-настоящему здорово посмотреть на такое количество коллег вживую, а не в виде потока электронов.</p>
<p class="measure-wide">Чтобы два раза не <s>вставать</s> летать, сдал в офисе PostgresPro <a class="link blue dim bb" href="https://postgrespro.ru/education/exam/DBA1-10" target="_blank">входной тест</a> по администрированию PostgreSQL. Впереди ещё три, а финального пока вообще не существует — но дорогу осилит идущий, так вижу.</p></description>
        </item>
        
        <item>
            <title>Матрёшка</title>
            <link>https://kostyanetsky.ru/notes/matryoshka/</link>
            <guid isPermaLink="false">note-matryoshka</guid>
            <pubDate>Sat, 30 Oct 2021 17:14:56 +0700</pubDate>
            <description><p class="measure-wide">На днях в чат команды кинули ссылку на сертификат 1Ci (коллега проходил их <a class="link blue dim bb" href="https://academy.1ci.com/courses/1c-junior-developer" target="_blank">курс</a> на джуна). Перехожу по ней — авторизации не требует, ошибки не выдает, браузер сразу загружает PDF. Всё идёт как надо, верно? Ладно, открываю файл:</p>
<p class="measure-wide"><img alt="Error.pdf" src="https://kostyanetsky.ru/notes/matryoshka/not-your-certificate.png"/></p>
<p class="measure-wide">Честно? Я даже восхищён. Надо этот UX в наших продуктах внедрить: прожимаешь ты, например, печать документа, а он тебе — PDF! А в нём — ссылка на другой PDF! А в нём — entity is not filled, иди заполняй.</p>
<p class="measure-wide">Можно продать это как русский путь вывода ошибок: мол, у нас так исторически сложилось. Всё матрёшки виноваты, проклятые, и Кощей со своей иглой. Она, как вы помните, в яйце, а оно — в утке, которая в зайце, засунутом в сундук, и далее по цепочке вложенности.</p></description>
        </item>
        
        <item>
            <title>Управление вторым монитором из консоли</title>
            <link>https://kostyanetsky.ru/notes/2nd-monitor-and-console/</link>
            <guid isPermaLink="false">note-2nd-monitor-and-console</guid>
            <pubDate>Sat, 16 Oct 2021 19:55:48 +0700</pubDate>
            <description><p class="measure-wide">У меня стоят два монитора. Второй нужен во время встреч в Zoom или при совместной игре с друзьями (в обеих случаях туда удобно вывести камеры собеседников). Есть ещё несколько примеров, когда он полезен, но часто устройство просто простаивает. Чтобы не отвлекало, решил его выключать.</p>
<p class="measure-wide">В чем тут засада: средствами ОС управлять вторым монитором неудобно (несколько кликов, скроллить надо, да ещё всё время путаю, куда лезть — в «Параметры экрана» или «Персонализацию»). Хотелось бы одной командой, а команду — на хоткей. И в идеале из скрипта всем этим рулить.</p>
<p class="measure-wide">Скрипта я не нашел, но накопал готовую утилиту — <a class="link blue dim bb" href="https://www.nirsoft.net/utils/multi_monitor_tool.html" target="_blank">MultiMonitorTool</a>. Бесплатная. Под десятой виндой работает без проблем. Команды ниже включают-выключают 2-й монитор:</p>
<pre><code>MultiMonitorTool.exe /disable 2
MultiMonitorTool.exe /enable 2  
MultiMonitorTool.exe /switch 2
</code></pre>
<p class="measure-wide">Почему-то при включении монитора через enable или switch он иногда неверно позиционируется (например, до выключения он был справа, а после включения встал слева). Это поправимо. Сначала запишем конфигурацию в тот момент, когда включены оба монитора:</p>
<pre><code>MultiMonitorTool.exe /SaveConfig Monitors.cfg
</code></pre>
<p class="measure-wide">А потом, когда нужно включить монитор — загрузим сохранённый конфиг:</p>
<pre><code>MultiMonitorTool.exe /LoadConfig Monitors.cfg
</code></pre>
<p class="measure-wide">Утилита ещё много чего умеет (например, одна из команд перекидывает окна приложений между мониторами). Описание — по ссылке выше.</p></description>
        </item>
        
        <item>
            <title>Самые большие зарплаты</title>
            <link>https://kostyanetsky.ru/notes/top-salaries/</link>
            <guid isPermaLink="false">note-top-salaries</guid>
            <pubDate>Sat, 02 Oct 2021 16:49:35 +0700</pubDate>
            <description><blockquote>
<p class="measure-wide">Есть путь до CSV-файла, надо его открыть, прочитать заголовок (первая строка), найти колонку Salary и вывести топ 10 зарплат.</p>
<p class="measure-wide"><em><a class="link blue dim bb" href="https://t.me/nikitonsky_chat/26402" target="_blank">Ссылка</a></em></p>
</blockquote>
<p class="measure-wide">Вбросил свои <a class="link blue dim bb" href="https://gist.github.com/tonsky/881d5d8c4fbed818fe2905a7591a91e0#file-vkostyanetsky-1c" target="_blank">пять копеек</a> просто для полноты картины. Если забить на стабильность, читаемость и производительность — можно усечь где-то вдвое. Тут с самого начала было очевидно, что на баше выйдет короче, а на питоне проще — так что просто написал как привык.</p>
<p class="measure-wide">Из полезного: в комментариях к сообщению куча примеров на других языках. С некоторыми вообще до сих пор не сталкивался; было реально любопытно посмотреть на синтаксис и попробовать понять подход.</p>
<p class="measure-wide">В целом история напомнила <a class="link blue dim bb" href="https://bolknote.ru/tags/beer99/" target="_blank">хобби</a> Евгения Степанищева — писать вывод американской «песни о пиве» на всех языках подряд. Задача с чтением CSV, кстати, мне тоже кажется скорее фаном — слишком узкий кейс, чтобы на его базе что-то всерьёз сравнивать.</p>
<p class="measure-wide">Из смешного: у пары <a class="link blue dim bb" href="https://t.me/nikitonsky_pub/201?comment=26703" target="_blank">коллег</a> язык 1С вызвал настолько острые проблемы со зрением, что они сочли нужным об этом сообщить :-) Отчасти понимаю желание самоутвердиться на стереотипе «1С — это плохо, понятненько?», но тут момент явно выбран неудачно. Предпочтения в синтаксисе — дело вкуса, а кроме них решение на 1С никак не отличается от решений на любом другом языке, где нет встроенной библиотеки для парсинга CSV.</p></description>
        </item>
        
        <item>
            <title>Сборка этого сайта на GitHub</title>
            <link>https://kostyanetsky.ru/notes/build-on-github/</link>
            <guid isPermaLink="false">note-build-on-github</guid>
            <pubDate>Wed, 29 Sep 2021 22:00:00 +0700</pubDate>
            <description><p class="measure-wide">Последний год этот сайт работал на простой связке: статика, гитхаб и свой домен. То есть все страницы были заранее сгенерированы и лежали в <a class="link blue dim bb" href="https://github.com/vkostyanetsky/kostyanetsky.ru-static" target="_blank">репе</a> гитхаба, к которой был подключен <a class="link blue dim bb" href="https://pages.github.com/" target="_blank">GitHub Pages</a>.</p>
<p class="measure-wide">Статику я собирал с помощью скрипта, на вход которому подавались педантично разложенные по папкам текстовые файлы с содержимым страниц. Скрипт рылся в них и генерил html-ки, которые я потом вручную перекладывал в репу.</p>
<p class="measure-wide">Эта схема, в общем, неплохо работала, но меня раздражало количество кликов. Здесь скрипт дерни, там скрипт дерни, потом ещё с гитом повозиться надо. Хотелось бы попроще.</p>
<p class="measure-wide">В какой-то момент до меня дошло, что на плечи гитхаба можно переложить не только деплой статики, но и саму сборку. Я поворочал мозгами и добавил к репозиторию со статикой ещё два:</p>
<ol class="measure-wide">
<li><a class="link blue dim bb" href="https://github.com/vkostyanetsky/kostyanetsky.ru" target="_blank">Репозиторий</a> исходных данных. Сюда я положил контент сайта: те самые текстовые файлы и чуть-чуть метаданных (заголовки страниц, даты их создания, теги для заметок и так далее).</li>
<li><a class="link blue dim bb" href="https://github.com/vkostyanetsky/BlogBuilder" target="_blank">Репозиторий</a> скрипта для генерации статики. Кроме самого скрипта, сюда я засунул разные ассеты (иконки, стили, манифесты — в общем, всё, что не нужно каждый раз генерировать, а можно просто «положить» рядом с получившимися html-ками).</li>
</ol>
<p class="measure-wide">Потом я накатал <a class="link blue dim bb" href="https://github.com/vkostyanetsky/kostyanetsky.ru/blob/main/.github/workflows/main.yml" target="_blank">экшен</a>, который просыпается при каждом пуше в репу с исходными данными. Вкратце, его логика:</p>
<ol class="measure-wide">
<li>Клонировать репу со статикой и репу с генератором;</li>
<li>Обновить репу со статикой с помощью генератора;</li>
<li>Запушить изменения репы со статикой в мейн;</li>
<li>Написать хозяину (мне) в телегу.</li>
</ol>
<p class="measure-wide">Вуаля! Теперь при любом изменении репозитория с исходными данными гитхаб немедленно (ну, как немедленно — в пределах минуты) обновляет репозиторий с готовым сайтом и деплоит его оттуда через GitHub Pages. Бонусом — веб-интерфейс для правки страниц сайта (собственно, сайт гитхаба). Почти чистый No Code :-)</p>
<p class="measure-wide">Чтобы два раза не вставать, я добавил ссылки для правки страниц прямо на сайт (карандаш в верхнем правом углу). Это задумано как удобство для меня, но вообще отправить PR может любой, кто, например, найдёт опечатку. Заранее спасибо!</p></description>
        </item>
        
    </channel>
</rss>