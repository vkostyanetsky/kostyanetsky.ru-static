

<!doctype html>
<html lang="ru" class="text-[18px] leading-[1.65]">
  <head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">

    <title>Заметки</title>

    <meta name="description" content="" />
    
    <!-- RSS -->

    <link rel="alternate" type="application/rss+xml" title="Сайт Влада" href="https://kostyanetsky.ru/rss.xml" />

    <!-- Icons -->

    <link rel="icon" href="https://kostyanetsky.ru/favicon.ico">
    <link rel="icon" href="https://kostyanetsky.ru/assets/icons/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="https://kostyanetsky.ru/assets/icons/apple-touch-icon.png">
    <link rel="manifest" href="https://kostyanetsky.ru/manifest.webmanifest">    

    <!-- Open Graph -->

    <meta property="og:title" content="Заметки"/>
    <meta property="og:description" content=""/>
    <meta property="og:image" content="https://kostyanetsky.ru/assets/images/og.jpg">
    <meta property="og:type" content="article"/>
    <meta property="og:url" content= "https://kostyanetsky.ru/notes/page-2" />    

    <!-- CSS -->
     
    <link rel="stylesheet" href="/assets/css/tailwind.css">
    <link rel="stylesheet" href="/assets/css/site.css">

    <!-- Blog -->

    <script>
        let ctrlLeftUrl     = 'https://kostyanetsky.ru/notes/page-3';
        let ctrlRightUrl    = 'https://kostyanetsky.ru/notes';
    </script>
    
    <script src="https://kostyanetsky.ru/assets/js/hotkeys.js"></script>    

  </head>

  <body class="min-h-screen bg-white text-slate-900">

    <!-- header -->
    <header class="border-b border-slate-200">
        <div class="mx-auto w-full max-w-4xl px-4 py-5">
            <div class="flex flex-wrap items-baseline gap-x-5 gap-y-2">

                <!-- header: main menu -->
                <nav class="flex flex-wrap items-baseline gap-x-5 gap-y-2 text-sm">
                    
                    
                    
                    
                    

                    
                    
                    <a class="inline-block text-[1.25rem] leading-tight mr-4 border-b border-current no-underline transition-opacity hover:opacity-70 text-blue-600" href="https://kostyanetsky.ru/">Сайт Влада</a>
                    

                    
                    
                    <a class="inline-block text-[1.25rem] leading-tight mr-4 border-b border-current no-underline transition-opacity hover:opacity-70 text-blue-600" href="https://kostyanetsky.ru/projects/">Проекты</a>
                    

                    
                    
                    <a class="inline-block text-[1.25rem] leading-tight mr-4 border-b border-current no-underline transition-opacity hover:opacity-70 text-orange-600" href="https://kostyanetsky.ru/notes/">Заметки</a>
                    
                </nav>

                <!-- header: mirror link & edit link -->
                <div class="ml-auto flex items-center gap-4">
                    
                    
                        <span
                        class="inline-block text-[1.35rem] leading-none text-slate-400"
                        title="Видите опечатку? Поправьте меня!"
                        aria-disabled="true"
                        >✎</span>
                    
                    

                    
                    
                    <a
                        href="https://kostyanetsky.me/notes/page-2"
                        class="inline-block text-[1rem] leading-tight text-blue-600 border-b border-current no-underline transition-opacity hover:opacity-70"
                        title="EN"
                    >
                        EN
                    </a>
                    
                </div>
            </div>
        </div>
    </header>

    <!-- content -->
    <main
      class="mx-auto w-full max-w-4xl px-4 py-10"
      id="pageMeta"
      data-page="2"
      data-total-notes="20"
      data-total-pages="12"
    >
      <a id="top" class="block scroll-mt-24"></a>

      

    

      <header class="space-y-3">
        <h1 class="text-3xl font-semibold tracking-tight">Заметки</h1>
        <p class="max-w-2xl text-slate-700">
          Мои мысли о жизни, работе и разных интересных штуках вокруг меня.
        </p>
      </header>



      <section class="mt-8 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
        <div class="relative w-full sm:w-[420px]">
          <input
            id="search"
            type="search"
            placeholder="Поиск по заголовку / тексту / тегам…"
            class="w-full rounded-xl border border-slate-200 bg-white px-4 py-2.5 pr-10 text-sm text-slate-900 placeholder:text-slate-400 outline-none transition focus:border-slate-400"
          />
          <svg
            class="pointer-events-none absolute right-3 top-1/2 h-5 w-5 -translate-y-1/2 text-slate-400"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="m21 21-4.35-4.35m1.35-5.65a7 7 0 1 1-14 0 7 7 0 0 1 14 0Z"
            />
          </svg>
        </div>

        <p class="text-sm text-slate-600">
          Показано: <span id="count" class="font-semibold text-slate-900">0</span>
          <span class="text-slate-400">·</span>
          <span id="pageInfo">Страница</span>
        </p>
      </section>

      <section class="mt-4 flex flex-wrap gap-2">
      
        <button
          data-chip="all"
          class="chip rounded-full border border-slate-200 bg-slate-100 px-3 py-1.5 text-xs text-slate-900 hover:bg-slate-200"
        >
          Все
        </button>

        
        <button
          data-chip="1c"
          class="chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50"
        >
          1С
        </button>
        
        <button
          data-chip="work"
          class="chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50"
        >
          Работа
        </button>
        
        <button
          data-chip="done"
          class="chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50"
        >
          Готово
        </button>
        
        <button
          data-chip="videogames"
          class="chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50"
        >
          Видеоигры
        </button>
        
        <button
          data-chip="meanwhile"
          class="chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50"
        >
          Тем временем
        </button>
        
        <button
          data-chip="english"
          class="chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50"
        >
          English
        </button>
        
        <button
          data-chip="bash"
          class="chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50"
        >
          Bash
        </button>
        
        <button
          data-chip="code-smell"
          class="chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50"
        >
          Код с запашком
        </button>
        
        <button
          data-chip="family"
          class="chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50"
        >
          Семья
        </button>
        
        <button
          data-chip="mssql"
          class="chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50"
        >
          MS SQL
        </button>
        
        <button
          data-chip="blog"
          class="chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50"
        >
          Блог
        </button>
        
        <button
          data-chip="workplace"
          class="chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50"
        >
          Рабочее место
        </button>
        
        <button
          data-chip="javascript"
          class="chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50"
        >
          Javascript
        </button>
        
        <button
          data-chip="obsidian"
          class="chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50"
        >
          Obsidian
        </button>
        
        <button
          data-chip="pgsql"
          class="chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50"
        >
          PostgreSQL
        </button>
        
        <button
          data-chip="python"
          class="chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50"
        >
          Python
        </button>
        
        <button
          data-chip="webdev"
          class="chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50"
        >
          Вебдев
        </button>
        
        <button
          data-chip="georgia"
          class="chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50"
        >
          Грузия
        </button>
        
        <button
          data-chip="optimization"
          class="chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50"
        >
          Оптимизация
        </button>
        
        <button
          data-chip="sport"
          class="chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50"
        >
          Спорт
        </button>
        
        <button
          data-chip="3d"
          class="chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50"
        >
          3D
        </button>
        
        <button
          data-chip="ai"
          class="chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50"
        >
          ИИ
        </button>
        
        <button
          data-chip="bitrix"
          class="chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50"
        >
          Битрикс
        </button>
        
        <button
          data-chip="books"
          class="chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50"
        >
          Книги
        </button>
        
        <button
          data-chip="powershell"
          class="chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50"
        >
          Powershell
        </button>
        
        <button
          data-chip="typescript"
          class="chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50"
        >
          Typescript
        </button>
        
        <button
          data-chip="nodejs"
          class="chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50"
        >
          Node.js
        </button>
        

      </section>

      <!-- Static notes (SEO + no-JS fallback) -->
      <section id="staticNotes" class="mt-10 space-y-12">
        
            

        <article class="rounded-2xl bg-white">

          <header class="space-y-2">

                        
            <header class="space-y-2">
            <a href="https://kostyanetsky.ru/notes/butterfly"
                class="inline text-2xl font-semibold tracking-tight hover:underline">
                Лог и баг
            </a>
            </header>
            

            <div class="flex flex-wrap items-center gap-x-3 gap-y-2 text-sm text-slate-600">
              <span>12 октября 2024</span>
              
                <span class="text-slate-300">·</span>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">English</span>
                </div>
                
              
            </div>

          </header>

          <div class="mt-5">
            <div class="prose-like">
              <p>Люблю иногда покопаться в происхождении слов. Например, «лог» пришло из морского дела и означало буквально бревно: деревянный поплавок, к которому прикрепляли веревку и бросали за борт судна. Верёвка имела узлы на равных промежутках, и по числу узлов, которые успевали размотаться за определённое время, моряки определяли скорость судна.</p>
<p>Эти измерения записывались в судовом журнале, который тоже назывался логом. Со временем так стали называть вообще любой журнал или запись о каком-то событии, а в айти слово вообще обрело вторую жизнь :)</p>
<p>Или, скажем, «баг» — ну, про это, наверное, все слышали? Мотылек, который семьдесят с гаком лет назад помешал работе компьютера, был отмечен в журнале как «first actual case of bug being found», и пошло-поехало. Насекомое получило своего рода цифровое бессмертие: теперь так называют любую ошибку, особенно в программе. </p>
<p>(Жаль только, что это было не какое-нибудь насекомое посимпатичнее — ну, не знаю, бабочка? Это прибавило бы нашей работе нотку романтики)</p>
<p>(Впрочем, если подумать... Может, «bug» и не такой плохой вариант. «Butterfly» — как-то длинновато. Кто-нибудь быстро сократил бы это до «butt», и чинили бы мы сейчас не баги, а жопы)</p>
            </div>
          </div>
          
        </article>


        
            

        <article class="rounded-2xl bg-white">

          <header class="space-y-2">

                        
            <header class="space-y-2">
            <a href="https://kostyanetsky.ru/notes/love"
                class="inline text-2xl font-semibold tracking-tight hover:underline">
                Мимикрия ChatGPT
            </a>
            </header>
            

            <div class="flex flex-wrap items-center gap-x-3 gap-y-2 text-sm text-slate-600">
              <span>29 сентября 2024</span>
              
                <span class="text-slate-300">·</span>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">ИИ</span>
                </div>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">Видеоигры</span>
                </div>
                
              
            </div>

          </header>

          <div class="mt-5">
            <div class="prose-like">
              <p>Коллеги вовсю <a href="https://t.me/denissexy/8767" target="_blank">экспериментируют</a> с o1-preview от OpenAI: модель получилась по-настоящему интересной. Жаль, задачи для неё попадаются не так уж часто: с большинством повседневных прекрасно справляется и обычная 4o. Поиск ошибок в коде, анализ медицинских тестов на незнакомом языке, попытки вспомнить название книги, которую читал в детстве и едва помнишь завязку — я сходу и не вспомню, что ей не по зубам.</p>
<p>Каждый раз любопытно смотреть, как ИИ рассуждает, шутит и вообще, старается выглядеть как человек. Я бы сказал, что тест Тьюринга эта штука пока не пройдёт, но время от времени стреляет пугающе близко.</p>
<p><img alt="Морковка" src="https://kostyanetsky.ru/notes/love/carrot.jpg"/> <img alt="Кулаки" src="https://kostyanetsky.ru/notes/love/fists.jpg"/> <img alt="Угараешь?" src="https://kostyanetsky.ru/notes/love/joke.jpg"/></p>
<p>А вот ответ ниже прямо порадовал. Даже если оставить за скобками философию — Скайнет, похоже, отменяется! :) Впрочем, будущее из финала <a href="https://store.steampowered.com/app/282140/SOMA/" target="_blank">SOMA</a> — пока, боюсь, нет.</p>
<p><img alt="Любовь" src="https://kostyanetsky.ru/notes/love/love.jpg"/></p>
            </div>
          </div>
          
        </article>


        
            

        <article class="rounded-2xl bg-white">

          <header class="space-y-2">

                        
            <header class="space-y-2">
            <a href="https://kostyanetsky.ru/notes/thumbs-up"
                class="inline text-2xl font-semibold tracking-tight hover:underline">
                Во!
            </a>
            </header>
            

            <div class="flex flex-wrap items-center gap-x-3 gap-y-2 text-sm text-slate-600">
              <span>21 сентября 2024</span>
              
                <span class="text-slate-300">·</span>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">Тем временем</span>
                </div>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">Грузия</span>
                </div>
                
              
            </div>

          </header>

          <div class="mt-5">
            <div class="prose-like">
              <p>Звонок в дверь. Открываю и вижу двух сияющих девушек лет двадцати. Ослепительно улыбаются мне и начинают что-то наперебой тараторить. </p>
<p>Грузинский язык красивый, но на слух я его совсем не понимаю. Вздохнул, предложил перейти на английский или русский.</p>
<p>Девушки насупились. Потом одна выудила из сумки раздатку, показала на неё, потом показала мне большой палец — типа, во! — и сунула её мне в руки. </p>
<p>Рассмеялись и убежали.</p>
<p>Так тебе, языковой барьер, получай!</p>
            </div>
          </div>
          
        </article>


        
            

        <article class="rounded-2xl bg-white">

          <header class="space-y-2">

                        
            <header class="space-y-2">
            <a href="https://kostyanetsky.ru/notes/pdf"
                class="inline text-2xl font-semibold tracking-tight hover:underline">
                Про PDF
            </a>
            </header>
            

            <div class="flex flex-wrap items-center gap-x-3 gap-y-2 text-sm text-slate-600">
              <span>6 сентября 2024</span>
              
                <span class="text-slate-300">·</span>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">Работа</span>
                </div>
                
              
            </div>

          </header>

          <div class="mt-5">
            <div class="prose-like">
              <p>Получаю жалобу: клиент не может войти на наш портал. Смотрю в базе — учетная запись в порядке. Что не так-то? Проверяю логин и вижу чудную картину:</p>
<p><img alt="PDF" src="https://kostyanetsky.ru/notes/pdf/pdf.png"/></p>
<p>Выше то, что вводит пользователь, а ниже — то, что в базе. Первая мысль: откуда, черт подери, в строке взялся документ? :D </p>
<p>Опущу дальнейший разбор. Главное тут — задавать правильные вопросы (иначе и гугл, и ИИ будут рассуждать о популярном формате, а не о символе). Короче, PDF в контексте Юникода означает Pop Directional Formatting! Это символ, который управляет направлением текста; он нужен, например, чтобы корректно рендерить арабский язык (где может встречаться как текст слева направо, так и справа налево). Пользователь, очевидно, вводит логин в режиме RTL (или копирует откуда-то), а портал этого нюанса не понимает.</p>
<p>В общем, дело на одну трубку. Однако хочу заметить: формат PDF появился задолго до символа PDF. Я понимаю, что это разные технические сферы и разработчики могли счесть пересечение терминологии несущественной проблемой. Но в глубине души я уверен: кто-то из них точно ехидно улыбался, предвидя сегодняшнюю путаницу.</p>
            </div>
          </div>
          
        </article>


        
            

        <article class="rounded-2xl bg-white">

          <header class="space-y-2">

                        
            <header class="space-y-2">
            <a href="https://kostyanetsky.ru/notes/rapture"
                class="inline text-2xl font-semibold tracking-tight hover:underline">
                Восторг
            </a>
            </header>
            

            <div class="flex flex-wrap items-center gap-x-3 gap-y-2 text-sm text-slate-600">
              <span>31 августа 2024</span>
              
                <span class="text-slate-300">·</span>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">1С</span>
                </div>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">PostgreSQL</span>
                </div>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">3D</span>
                </div>
                
              
            </div>

          </header>

          <div class="mt-5">
            <div class="prose-like">
              <p>Помню, в каком восторге я был, когда впервые поработал с оконными функциями в PostgreSQL. Можно построчно регулировать окошко вычислений для каждой строки! И на сегменты предварительно нарезать! И всё
 это — нативно, внутри самого обычного запроса, никаких пристроек справа и слева. Стандартная агрегация с группировкой и подзапросами, к которой я привык в 1С, резко превратилась в тыкву, совсем как карета Золушки в полночь.</p>
<p>Последнее время осваиваю Blender и внезапно ощутил то же чувство по той же самой причине. То, что объект можно произвольно таскать по 3D Viewport через команду Move, было понятно ещё на берегу, ладно. Но когда до меня дошло, что каждый объект — это набор полигонов, и каждый из таких полигонов тоже можно произвольно таскать, и это приводит к естественному изменению геометрии объекта — вот тут-то меня и накрыло.</p>
<p>Технологии удивительны. Учиться — клёво. Ради таких озарений хочется делать это ещё и ещё :)</p>
            </div>
          </div>
          
        </article>


        
            

        <article class="rounded-2xl bg-white">

          <header class="space-y-2">

                        
            <header class="space-y-2">
            <a href="https://kostyanetsky.ru/notes/nowhere-to-run"
                class="inline text-2xl font-semibold tracking-tight hover:underline">
                Некуда бежать
            </a>
            </header>
            

            <div class="flex flex-wrap items-center gap-x-3 gap-y-2 text-sm text-slate-600">
              <span>31 августа 2024</span>
              
                <span class="text-slate-300">·</span>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">1С</span>
                </div>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">Спорт</span>
                </div>
                
              
            </div>

          </header>

          <div class="mt-5">
            <div class="prose-like">
              <p>Вчера решил отвлечься от работы и как следует побегать. Выбрался в местный парк, сделал несколько кругов. Сижу, перевожу дух, беру смартфон, чтобы переключить трек, а там — поздравление от фитнес-трекера.</p>
<p><img alt="Ой, привет!" src="https://kostyanetsky.ru/notes/nowhere-to-run/hi.jpg"/></p>
<p>Отвлекся, блин. Платформа следит за тобой, %username%!</p>
<p>P.S. Зато теперь у меня есть кастомный значок с символикой любимой компании!</p>
            </div>
          </div>
          
        </article>


        
            

        <article class="rounded-2xl bg-white">

          <header class="space-y-2">

                        
            <header class="space-y-2">
            <a href="https://kostyanetsky.ru/notes/system-analysis-course"
                class="inline text-2xl font-semibold tracking-tight hover:underline">
                Анализ систем
            </a>
            </header>
            

            <div class="flex flex-wrap items-center gap-x-3 gap-y-2 text-sm text-slate-600">
              <span>25 августа 2024</span>
              
                <span class="text-slate-300">·</span>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">Готово</span>
                </div>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">Тем временем</span>
                </div>
                
              
            </div>

          </header>

          <div class="mt-5">
            <div class="prose-like">
              <p>Среди всех этих пет-проектов и августовских переживаний забыл упомянуть, что завершил <a href="https://tough-dev.school/system-analysis" target="_blank">курс</a> по анализу систем, о котором недавно <a href="https://kostyanetsky.ru/notes/ibrahim" target="_blank">писал</a>.</p>
<p><img alt="Сертификат" src="https://kostyanetsky.ru/notes/system-analysis-course/certificate.png"/></p>
<p>Курс был устроен так, что на протяжении всех занятий мы работали над одной и той же системой, выявляли проблемы и постепенно их решали. Перед первым уроком нам предложили спроектировать первую версию системы, чтобы потом, в конце курса, сравнить её с финальной версией и оценить прогресс. Так вот, сравнением я доволен — в том смысле, что на первую версию теперь без слез смотреть сложно :)</p>
<p>Времени для рефлексии было в целом мало, так что буду дальше работать над материалами и растаскивать уроки на личные заметки. Это не так-то просто, так как у нас в компании много специфики связано с решениями на базе 1С:Предприятия, и масса моей работы крутится вокруг разной обвязки 1С-инстансов на решениях вне стека 1С. </p>
<p>Однако 1С-инстансы, кажется, можно воспринимать как монолиты с определенным набором характеристик (в зависимости от решаемых внутри задач), а в остальном коммуникации с ними мало чем отличаются от традиционных решений: те же события (например, кролик), те же входящие/исходящие HTTP-вызовы, тот же показатель instability и так далее.</p>
<p>На этом этапе я точно потащу (или уже потащил) к себе:</p>
<ol>
<li>Распил ТЗ на нумерованные пункты (US-XXX) и хранение их в одном месте с пометками «updated at», «canceled at» и так далее. Кажется, удачный формат.</li>
<li>Ведение ADR. Собственно, это уже внедрил. Несколько смущает, правда, что в них периодически оседает что-то, что архитектурой в прямом смысле не является (например, принципы логирования событий на каком-то участке). Однако такие штуки тоже кажутся важными для принятия решений.</li>
<li>Event Storming как способ визуализации бизнес-процессов. Не могу сказать, что он сильно выигрывает по сравнению с той сборной солянкой, которая до этого обычно оседала у нас, но результат выглядит симпатично и вообще: какой-то стандарт лучше, чем никакого.</li>
<li>Диаграммы сервисов приложения с наклеенными стикерами, указывающими характеристики. Достаточно функционально, если надо взглянуть на проект с высоты птичьего полета и опять же не так сухо, как гигантские таблицы. То есть, если сработает bus factor — выше шанс, что следующий (или следующая) я заметит эти детали.</li>
<li>Хочу делать BPMN-ки и Activity Diagrams. Формат мне нравится, но пока мои попытки оставляют желать лучшего. Буду пробовать ещё.</li>
<li>Неожиданно зашел концепт разделения функционала для снижения зависимостей. Раньше казалось, что всегда проще склеить похожий функционал для снижения объёма кода, но это увеличивает и сложность, и внутреннюю связность — а значит, может сильно больше вредить, чем помогать.</li>
</ol>
<p>В целом курсом очень доволен. Лучшее вложение сил за последний год. Если думаете идти туда, но сомневаетесь — идите :)</p>
            </div>
          </div>
          
        </article>


        
            

        <article class="rounded-2xl bg-white">

          <header class="space-y-2">

                        
            <header class="space-y-2">
            <a href="https://kostyanetsky.ru/notes/first-pancake"
                class="inline text-2xl font-semibold tracking-tight hover:underline">
                Мой первый подход к генеративкам
            </a>
            </header>
            

            <div class="flex flex-wrap items-center gap-x-3 gap-y-2 text-sm text-slate-600">
              <span>25 августа 2024</span>
              
                <span class="text-slate-300">·</span>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">ИИ</span>
                </div>
                
              
            </div>

          </header>

          <div class="mt-5">
            <div class="prose-like">
              <p>Понадобилось по-быстрому наделать картинок для одного пет-проекта. Развернул первое, что под руку попалось — <a href="https://huggingface.co/hakurei/waifu-diffusion" target="_blank">WaifuDiffusion</a> (это такой клон <a href="https://huggingface.co/stabilityai/stable-diffusion-3-medium" target="_blank">StableDiffusion</a>, но обученный на аниме и манге).</p>
<p>Запрос: </p>
<blockquote>
<p>A dimly lit, empty classroom with faintly visible music notes on the chalkboard. A young woman with long blue hair and blue eyes, is standing behind the teacher's desk, packing her things into a small handbag. She looks tired and worried.</p>
</blockquote>
<p>Результат:</p>
<p><img alt="Молодая женщина" src="https://kostyanetsky.ru/notes/first-pancake/young-woman.jpg"/></p>
<p>Кажется, это отличный повод поговорить о том, как далеко вперед шагнули нейросети! Модель с порога раскусила задумку и предложила ввести в сюжет... Хм... Мудрого бородача? Или, возможно, намекнула, что я должен больше ценить неожиданные сюрпризы?</p>
<p>Думаю, WaifuDiffusion просто решила поднять мне настроение. Смех, говорят, продлевает жизнь. В любом случае, первую генерацию считаю успешной! Но над калибровкой явно придется поработать еще :)</p>
            </div>
          </div>
          
        </article>


        
            

        <article class="rounded-2xl bg-white">

          <header class="space-y-2">

                        
            <header class="space-y-2">
            <a href="https://kostyanetsky.ru/notes/obsidian-day-switcher"
                class="inline text-2xl font-semibold tracking-tight hover:underline">
                Переключалка дней для Obsidian
            </a>
            </header>
            

            <div class="flex flex-wrap items-center gap-x-3 gap-y-2 text-sm text-slate-600">
              <span>17 августа 2024</span>
              
                <span class="text-slate-300">·</span>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">Obsidian</span>
                </div>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">Javascript</span>
                </div>
                
              
            </div>

          </header>

          <div class="mt-5">
            <div class="prose-like">
              <p>Когда активно работаешь в ежедневных заметках Obsidian'а, часто хочется сунуть нос в заметку за вчера или, наоборот, на завтра. Например, когда сортируешь сегодняшние задачи и хочешь отложить часть на завтра.</p>
<p>Каждый раз набирать нужную дату мне лень, поэтому я написал под это <a href="https://gist.github.com/vkostyanetsky/6c70f00b817157f9b6e62ee89bade853" target="_blank">скрипт</a>. Берет дату заметки из её названия (ожидает, что она в формате <abbr title="2024-08-17, например.">ISO 8601</abbr>) и рисует выноску со ссылками на вчера и завтра для неё. В заголовке выводит день недели для дополнительного удобства:</p>
<p><img alt="Пример" src="https://kostyanetsky.ru/notes/obsidian-day-switcher/callout.jpg"/></p>
<p>Скрипт написан для плагина <a href="https://github.com/blacksmithgu/obsidian-dataview" target="_blank">Dataview</a>, потому что я его и так использую для других задач. Можно легко переделать его для <a href="https://github.com/SilentVoid13/Templater" target="_blank">Templater</a>, <a href="https://github.com/saml-dev/obsidian-custom-js" target="_blank">CustomJS</a> или отдельный плагин накидать (мне, опять-таки, было лень возиться). </p>
<p>Если будете использовать: </p>
<ol>
<li>В функции noteLink() пропишите путь к вашей папке с ежедневными заметками (сейчас в ней папка Days для примера; путь, если забыли, указан в настройке Daily notes/New file location);</li>
<li>Закиньте скрипт в шаблон ежедневной заметки (настройка Daily notes/Template file location).</li>
</ol>
            </div>
          </div>
          
        </article>


        
            

        <article class="rounded-2xl bg-white">

          <header class="space-y-2">

                        
            <header class="space-y-2">
            <a href="https://kostyanetsky.ru/notes/clementine"
                class="inline text-2xl font-semibold tracking-tight hover:underline">
                Клементина запомнит это
            </a>
            </header>
            

            <div class="flex flex-wrap items-center gap-x-3 gap-y-2 text-sm text-slate-600">
              <span>9 августа 2024</span>
              
                <span class="text-slate-300">·</span>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">ИИ</span>
                </div>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">Видеоигры</span>
                </div>
                
              
            </div>

          </header>

          <div class="mt-5">
            <div class="prose-like">
              <p>Когда ChatGPT запоминает какую-то деталь диалога на будущее, он рисует над своим ответом плашку "Memory updated". Типа, я понял:</p>
<p><img alt="Memory updated" src="https://kostyanetsky.ru/notes/clementine/memory-updated.jpg"/></p>
<p>Каждый раз смешно: сразу вспоминается <a href="https://store.steampowered.com/app/207610/The_Walking_Dead/" target="_blank">The Walking Dead</a> и мем «Клементина запомнит это» :) В этой игре персонажи, окружающие протагониста, запоминали его решения и это оказывало влияние на их поведение. В том числе и Клементина — девочка, которую главный герой спасает в начале игры.</p>
<p><img alt="Клементина запомнит это" src="https://kostyanetsky.ru/notes/clementine/remember.jpeg"/></p>
<p>В игре эта механика была сделана, если честно, так себе, а вот ChatGPT и правда все запоминает. Внимание к деталям такое, что иногда приходится напоминать себе, что разговариваешь с языковой моделью, а не с необыкновенно участливым и очень эрудированным человеком.</p>
            </div>
          </div>
          
        </article>


        
            

        <article class="rounded-2xl bg-white">

          <header class="space-y-2">

                        
            <header class="space-y-2">
            <a href="https://kostyanetsky.ru/notes/make-my-window-a-door"
                class="inline text-2xl font-semibold tracking-tight hover:underline">
                Сделать окно дверью
            </a>
            </header>
            

            <div class="flex flex-wrap items-center gap-x-3 gap-y-2 text-sm text-slate-600">
              <span>4 августа 2024</span>
              
                <span class="text-slate-300">·</span>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">English</span>
                </div>
                
              
            </div>

          </header>

          <div class="mt-5">
            <div class="prose-like">
              <p>Вчера во время прогулки слушал <a href="https://music.yandex.ru/album/13443698/track/24134841" target="_blank">Be Somebody</a> от Thousand Foot Krutch и неожиданно зацепился за фразу «you made my window a door». Мне эта идиома всегда казалась забавной: блин, врезать дверь вместо окна — это как-то небезопасно звучит. Можно выпасть с десятого этажа, например. </p>
<p>Но песня-то чудесная и совсем не про то! Стало любопытно; пошел копаться, какой смысл вкладывают носители языка. </p>
<p>Оказалось, это про две разные позиции: пассивный наблюдатель и активный участник. То есть, если перед тобой окно — ты лишь смотришь сквозь него на что-то или кого-то. А вот дверь можно открыть и что-то сделать. Так что «when I could only see the floor you made my window a door» — это по смыслу что-то вроде «когда мои руки опустились, ты помогла мне встать».</p>
<p>Кстати, есть ещё одна похожая идиома — «to be a better window than a door». Абстракция здесь та же: если какой-то человек похож на окно, а не на дверь — он никогда не подпускает окружающих близко к себе, делая пассивных наблюдателей даже из очень близких ему людей.</p>
            </div>
          </div>
          
        </article>


        
            

        <article class="rounded-2xl bg-white">

          <header class="space-y-2">

                        
            <header class="space-y-2">
            <a href="https://kostyanetsky.ru/notes/yaga"
                class="inline text-2xl font-semibold tracking-tight hover:underline">
                Яга
            </a>
            </header>
            

            <div class="flex flex-wrap items-center gap-x-3 gap-y-2 text-sm text-slate-600">
              <span>29 июля 2024</span>
              
                <span class="text-slate-300">·</span>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">Тем временем</span>
                </div>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">1С</span>
                </div>
                
              
            </div>

          </header>

          <div class="mt-5">
            <div class="prose-like">
              <p>Случайно вспомнил, что полгода назад кто-то из коллег закинул в рабочий чат ссылку на <a href="https://yaga.rt.ru" target="_blank">Ягу</a> — будущего (наверное) конкурента JIRA в России. Разработкой, судя по URL, занимаются ребята из Ростелекома. Проснулось любопытство  — как оно там, взлетело?</p>
<p>Увы, но похоже, что нет. По крайней мере, на лендинге висит стандартное «оставьте заявку и ждите ответного гудка». Доступна урезанная версия для команд поменбше, но я сейчас не в России, и клик по кнопке «Начать пользоваться» приводит к бану. Ладно, как-нибудь в следующий раз.</p>
<p>Нейминг, конечно, у ребят кликбейтный. Но не уверен, что прям удачный. Например, название «1С», может, и провоцирует натужные шутки (один эс! задница Одина! хахаха!), но если ты гуглишь его — то, скорее, находишь инфу про платформу или хотя бы вендора. А не кучу статей, фанфиков, фанарта и видеоигр, как в случае с Ягой.</p>
<p>И вообще, ассоциации какие-то не те лезут. Избушка на курьих ножках? Выглядит как изначально <a href="https://kostyanetsky.ru/notes/evolution" target="_blank">плохо спроектированное</a> приложение, которое кое-как переделали прямо на проде. Ступа? Костыль? Блин, если смотреть с точки зрения программистов — тут не красные флаги, а алые знамена :)</p>
<p>Ну и я еще, наверное, испорченный, но при слове «Яга» у меня в голове первым делом всплывает не могущественная ведьма из славянского фольклора, а <a href="https://ru.wikipedia.org/wiki/Jaguar_(напиток)" target="_blank">отвратительное пойло</a> из двухтысячных.</p>
<blockquote>
<p>И вот баба с ягой уже не быдло, а патриотичная программистка!</p>
<p>― коллега</p>
</blockquote>
            </div>
          </div>
          
        </article>


        
            

        <article class="rounded-2xl bg-white">

          <header class="space-y-2">

                        
            <header class="space-y-2">
            <a href="https://kostyanetsky.ru/notes/ibrahim"
                class="inline text-2xl font-semibold tracking-tight hover:underline">
                Ибрагим
            </a>
            </header>
            

            <div class="flex flex-wrap items-center gap-x-3 gap-y-2 text-sm text-slate-600">
              <span>7 июля 2024</span>
              
                <span class="text-slate-300">·</span>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">Тем временем</span>
                </div>
                
              
            </div>

          </header>

          <div class="mt-5">
            <div class="prose-like">
              <p>Закатился в <a href="https://tough-dev.school/system-analysis" target="_blank">курс по анализу систем</a>, который проводят ребята из "Школы сильных программистов". Цели у меня две:</p>
<ol>
<li>Во-первых, надо откалиброваться. Много бодаюсь с полдюжиной технических стеков, у которых разный тулсет и понятия о прекрасном. Это, конечно, здорово развивает, но искажает перспективу: меня тянет решать очередную проблему со всяких второстепенных технических штук просто потому, что я это хорошо умею. Между тем, если посмотреть на задачу чуть сверху, подумать и порисовать диаграммы — получается более удачное или, хотя бы, более осмысленное решение. Хочу убедить себя делать так почаще.</li>
<li>Во-вторых, надо научиться писать внятную документацию для разработчиков. На практике до нее редко доходят руки, а когда доходят — не успеваю поддерживать её в актуальном состоянии. Короче, времени мало, и хочется по крайней мере делать доку как-то так, чтобы читатель живее хватался за мысль.</li>
</ol>
<p>Сам курс сделан в виде итераций: каждую неделю тебе рассказывают про один и тот же проект, который пытается спроектировать главный герой истории, Ибрагим (это он на лендинге по ссылке выше). Каждую неделю проблем с этим проектом все больше и решения, которые выдумывает Ибрагим, становятся все заковыристее. </p>
<p>Кроме этого, студентам регулярно выдают "домашнюю работу" — другой проект с похожими проблемами. Его нужно проанализировать и спроектировать по-человечески — снова и снова, учитывая новые знания и ограничения, полученные за неделю.</p>
<p>Пока здорово заходит. Главная проблема — нехватка времени: читаю я сравнительно медленно и стараюсь конспектировать самые интересные или просто сложные места. Между тем, материалов в курсе очень много и все интересные, даже если считать только основную часть.</p>
<p>А переходишь к дополнительным ссылкам — вообще хоть святых выноси. Нужно полгода, не меньше. Я старался читать их хотя бы по диагонали, но это оказалось чертовски плохой идеей: кончилось тем, что главный герой курса начал мне мерещиться в уличной рекламе :)</p>
<p><img alt="Ибрагим" src="https://kostyanetsky.ru/notes/ibrahim/ibrahim.jpg"/></p>
            </div>
          </div>
          
        </article>


        
            

        <article class="rounded-2xl bg-white">

          <header class="space-y-2">

                        
            <header class="space-y-2">
            <a href="https://kostyanetsky.ru/notes/singapore-doll"
                class="inline text-2xl font-semibold tracking-tight hover:underline">
                Сингапурская кукла
            </a>
            </header>
            

            <div class="flex flex-wrap items-center gap-x-3 gap-y-2 text-sm text-slate-600">
              <span>22 июня 2024</span>
              
                <span class="text-slate-300">·</span>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">Работа</span>
                </div>
                
              
            </div>

          </header>

          <div class="mt-5">
            <div class="prose-like">
              <p>Можно ли любить валюту своей страны сильнее, чем жители Саудовской Аравии? Вопрос риторический: уверен, что нет.</p>
<p>Разглядываю <a href="https://www.sama.gov.sa/en-US/FinExc/Pages/Currency.aspx" target="_blank">сайт</a> их центрального банка. Валюта страны — саудовский риал, и курсы других валют ЦБ устанавливает по отношению к ней. То есть, нет смысла спрашивать с банка курс самого риала. Однако сайт невозмутимо предлагает выбрать его дважды:</p>
<p><img alt="Форма выбора" src="https://kostyanetsky.ru/notes/singapore-doll/cb.png"/></p>
<p>Для справки: первый вариант ломает интерфейс, а второй педантично выдает единицу на любую дату.</p>
<p>Другая забавная деталь: коллеги, кажется, хранят названия валют как строки длиной в 14 символов. Иначе сложно объяснить, почему по их данным в Канаде используется не канадский доллар, а CANADIAN DOLLA, а в Румынии — загадочный NEW ROMANIAN L вместо леи. Впрочем, этим двоим ещё повезло: Сингапур, например, ведёт расчёты в SINGAPORE DOLL.</p>
            </div>
          </div>
          
        </article>


        
            

        <article class="rounded-2xl bg-white">

          <header class="space-y-2">

                        
            <header class="space-y-2">
            <a href="https://kostyanetsky.ru/notes/data-history-duplication"
                class="inline text-2xl font-semibold tracking-tight hover:underline">
                Не уникальные метаданные
            </a>
            </header>
            

            <div class="flex flex-wrap items-center gap-x-3 gap-y-2 text-sm text-slate-600">
              <span>8 июня 2024</span>
              
                <span class="text-slate-300">·</span>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">1С</span>
                </div>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">PostgreSQL</span>
                </div>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">MS SQL</span>
                </div>
                
              
            </div>

          </header>

          <div class="mt-5">
            <div class="prose-like">
              <p>В очередной раз столкнулся с противным багом, при котором платформа ломает таблицу с метаданными истории данных. </p>
<p>Внешне он выглядит так: вы обновляете конфигурацию базы, и при попытке реструктуризации выскакивает ошибка "Таблица метаданных истории данных cодержит не уникальные записи, которые должны быть удалены". </p>
<p>При этом платформа не предлагает никакого понятного способа найти такие записи — иди туда, не знаю куда, сделай то, не знаю что.   </p>
<p><img alt="Таблица метаданных истории данных cодержит не уникальные записи, которые должны быть удалены" src="https://kostyanetsky.ru/notes/data-history-duplication/error.png"/></p>
<p>Проблему можно решить, порывшись в базе данных. Таблица, на которую ссылается ошибка — _DataHistoryMetadata. В ней лежат версии метаданных каждого объекта, для которого ведётся история. Это позволяет платформе понимать, какие реквизиты были у объекта на любой момент времени, в течении которого для объекта велась история.</p>
<p>Как это работает? Ну, когда меняется состав реквизитов объекта (например, реквизит в справочнике добавили), платформа запоминает его метаданные: конкретно, добавляет в _DataHistoryMetadata новую запись и сохраняет в ней актуальный список реквизитов объекта, а также номер версии этого списка (например, в при включении истории для объекта сохраняется первая версия метаданных, при добавлении какого-нибудь реквизита — вторая и так далее).</p>
<p>Ещё платформа ставит в созданной записи отметку, что именно эта версия объекта — самая актуальная, после чего снимает этот флаг с той версии, которая была помечена актуальной до этого.</p>
<p>Так вот, проблема в том, что платформа иногда забывает сделать последний шаг и в таблице появляется сразу две версии, помеченные как актуальные. Конфигуратор понимает это, но сделать ничего не может.</p>
<p><img alt="Как помочь больной скотине?" src="https://kostyanetsky.ru/notes/data-history-duplication/howto.jpeg"/></p>
<p>Решение вытекает из алгоритма выше: нужно найти конфликтующие версии и отобрать признак актуальности у той, что старше. Лучше использовать запросы: историю данных включают, как правило, для кучи объектов и состав реквизитов у них постоянно меняется — в общем, версий в таблице будет столько, что черт ногу сломит.</p>
<p>Если вы тоже столкнулись с этой проблемой и поэтому читаете этот текст — можете воспользоваться <a href="https://gist.github.com/vkostyanetsky/6496c67e2b2fd3d064c4cafd16da0b79" target="_blank">запросами</a>, что написал я:</p>
<ol>
<li>get-issues.sql проверяет, что проблема есть: ищет версии метаданных, которые одновременно помечены как актуальные.</li>
<li>fix-issues.sql снимает признак актуальности с тех версий, которые на самом деле устарели.</li>
</ol>
<p>Оба запроса написаны для Microsoft SQL Server. Если вы используете PostgreSQL, то <a href="https://gist.github.com/vkostyanetsky/75665ce04247e900743604eb386d1889" target="_blank">вот они же</a> для этой СУБД.</p>
<p>Запросы потребуют небольшой адаптации под конкретную базу: в них используется поле _fld626, в котором хранится разделитель данных. В вашей таблице _DataHistoryMetadata это поле может называться иначе, поэтому нужно обновить его имя на актуальное. Ошибиться будет трудно — у таблицы только одно поле с префиксом _fld.</p>
<p>P.S. Напоминаю, что лицензионное соглашение запрещает ковыряться в базе данных в обход средств платформы, так что на такие эксперименты можно идти, только если других вариантов не осталось.</p>
            </div>
          </div>
          
        </article>


        
            

        <article class="rounded-2xl bg-white">

          <header class="space-y-2">

                        
            <header class="space-y-2">
            <a href="https://kostyanetsky.ru/notes/uuid-main-issue"
                class="inline text-2xl font-semibold tracking-tight hover:underline">
                Главная проблема UUID
            </a>
            </header>
            

            <div class="flex flex-wrap items-center gap-x-3 gap-y-2 text-sm text-slate-600">
              <span>2 июня 2024</span>
              
                <span class="text-slate-300">·</span>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">1С</span>
                </div>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">PostgreSQL</span>
                </div>
                
              
            </div>

          </header>

          <div class="mt-5">
            <div class="prose-like">
              <p>Наткнулся на <a href="https://www.cybertec-postgresql.com/en/unexpected-downsides-of-uuid-keys-in-postgresql/" target="_blank">хороший текст</a> об основной проблеме, которую таскает с собой UUID. Для 1С она тоже актуальна: все ссылочные объекты платформы (элементы справочников, документы и так далее) имеют собственные UUID. Они хранятся в БД, активно используются при поиске и, понятно, обильно индексируются (со всеми вытекающими последствиями). </p>
<p>1С старается компенсировать проблему, создавая последовательные UUID. Пусть не идеально, но в целом эта штука работает и индексы получаются более-менее ровными. Да и вообще в сообществе об этом говорят довольно давно: вот, например, бородатый <a href="https://forum.mista.ru/topic.php?id=801986" target="_blank">топик на Мисте</a> (правда, тут диалог быстро перерос в курятник и из шести десятков комментариев от силы полтора — по делу).</p>
<p>P.S. Рассмешила ремарка про вероятность создать в одной базе два одинаковых UUID:</p>
<blockquote>
<p>As an aside, for those worried about collisions: you should take up the lottery, since winning the jackpot twice in a row is a much more likely outcome than your system ever generating two identical random 128 bit numbers.</p>
</blockquote>
            </div>
          </div>
          
        </article>


        
            

        <article class="rounded-2xl bg-white">

          <header class="space-y-2">

                        
            <header class="space-y-2">
            <a href="https://kostyanetsky.ru/notes/last-resort"
                class="inline text-2xl font-semibold tracking-tight hover:underline">
                Скриншот со звуком
            </a>
            </header>
            

            <div class="flex flex-wrap items-center gap-x-3 gap-y-2 text-sm text-slate-600">
              <span>20 мая 2024</span>
              
                <span class="text-slate-300">·</span>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">Работа</span>
                </div>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">Тем временем</span>
                </div>
                
              
            </div>

          </header>

          <div class="mt-5">
            <div class="prose-like">
              <p>Недавно в компании родилась идея разделить внутреннюю ERP-шку на несколько независимых частей и организовать между ними обмен данными. Мы обсудили контуры задачи, модель обмена, транспорт, примерно подбились по срокам — в общем, привычная рутина.</p>
<p>Создал под весь этот огород задачу. Названия им мы даем на английском языке, так что вписал первую формулировку, которая пришла в голову.</p>
<p><img alt="Cut My Life Into Pieces" src="https://kostyanetsky.ru/notes/last-resort/last-resort.png"/></p>
<p>Заголовок вышел со звуком. Ладно, думаю, смешно, но как тогда назвать? Во, пусть будет Distributed Internal ERP. Сокращенно... DIE?</p>
<p>Оставил первый вариант. Long live Papa Roach :)</p>
            </div>
          </div>
          
        </article>


        
            

        <article class="rounded-2xl bg-white">

          <header class="space-y-2">

                        
            <header class="space-y-2">
            <a href="https://kostyanetsky.ru/notes/obsidian-timesheet"
                class="inline text-2xl font-semibold tracking-tight hover:underline">
                Таймшит для Обсидиана
            </a>
            </header>
            

            <div class="flex flex-wrap items-center gap-x-3 gap-y-2 text-sm text-slate-600">
              <span>12 мая 2024</span>
              
                <span class="text-slate-300">·</span>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">Готово</span>
                </div>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">Typescript</span>
                </div>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">Obsidian</span>
                </div>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">Работа</span>
                </div>
                
              
            </div>

          </header>

          <div class="mt-5">
            <div class="prose-like">
              <p>Написал ещё один плагин к <a href="https://obsidian.md" target="_blank">Obsidian</a>, на этот раз — для <a href="https://help.obsidian.md/Plugins/Daily+notes" target="_blank">ежедневных заметок</a>. Рисует симпатичный отчет: над какими задачами работал, что сделал, сколько времени потратил. Я постарался описать в <a href="https://github.com/vkostyanetsky/ObsidianTimesheet" target="_blank">репозитории</a>, как это работает; буду рад, если кому-то ещё пригодится!</p>
<p>Забавный момент: для примеров в README я использовал номера задач FBI-1, FBI-2 и так далее. Это не отсылка к X-Files или Twin Peaks — просто первое, что пришло мне в голову. Дело в том, что наш внутренний проект по разработке FirstBit ERP называется First Bit Internal, сокращенно — FBI. Основной пул задач, над которыми мы работаем, живёт именно в нём.</p>
<p>Мы-то уже привыкли, но коллег вне компании наши скриншоты из JIRA или SonarQube неизменно веселят. Представили, что вы — агент Купер? А мне и представлять не надо :)</p>
            </div>
          </div>
          
        </article>


        
            

        <article class="rounded-2xl bg-white">

          <header class="space-y-2">

                        
            <header class="space-y-2">
            <a href="https://kostyanetsky.ru/notes/payment-terms"
                class="inline text-2xl font-semibold tracking-tight hover:underline">
                Запросом больше, запросом меньше
            </a>
            </header>
            

            <div class="flex flex-wrap items-center gap-x-3 gap-y-2 text-sm text-slate-600">
              <span>5 мая 2024</span>
              
                <span class="text-slate-300">·</span>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">1С</span>
                </div>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">Оптимизация</span>
                </div>
                
              
            </div>

          </header>

          <div class="mt-5">
            <div class="prose-like">
              <p>Регулярно слышу тейк: запросом больше, запросом меньше — без разницы. Мол, главное, чтобы запрос был дешевым: не читал лишнего, попадал в индекс и так далее.</p>
<p>Эта точка зрения имеет право на жизнь, однако бездумно пулеметить запросами — опасная затея. Даже если в моменте все выглядит хорошо, в будущем система может слегка поменяться. А потом внешне безобидный патч положит вам прод в пятницу.</p>
<p>Пример из недавней практики. Есть ERP, в которой лежит таблица с этапами оплаты по заказам клиентов. Один из таких этапов — предоплата; пока она не внесена, создать заказ поставщику нельзя. </p>
<p>Технически в заказе поставщику просто хранится ID заказа клиента; если последний заполнен (то есть, заказ поставщику создан под заказ клиента), ERP нужно прочитать этапы оплаты по заказу клиента и понять, можно ли делать закупку. </p>
<p>Звучит элементарно, однако мониторинг показывает: операция тормозит и жрет память, будто в последний раз. Лезем разбираться. Видим примерно такую картинку:</p>
<p><img alt="825701 записей" src="https://kostyanetsky.ru/notes/payment-terms/payment-terms.png"/></p>
<p>То есть вместо того, чтобы выдернуть два-три этапа оплаты по заказу, ERP читает без малого миллион! Как так? </p>
<p>Опуская детали: проблема рождалась в тех заказах поставщику, которые вообще не были связаны с заказом клиента. Разработчик посчитал, что для них можно не менять логику: ID заказа клиента пустой и запрос не найдет для него этапов оплаты. А значит, получится тот же результат, как если бы запроса вообще не было. А лишний запрос — ну... Запросом больше, запросом меньше... Тоже мне, большое дело.</p>
<p>Оказалось, большое. В таблице этапов оплаты оказались данные не только для заказов клиентов, но и для других видов документов. Поле с ID заказа клиента у них было пустым. В итоге ERP при попытке найти этапы оплаты по пустому ID заказа клиента находила такие записи — и, как видите, немало.</p>
<p>Запрос читал порядка гигабайта данных и помещал во временную таблицу. Гигабайт прочитали, гигабайт записали... История била и по диску, и по буферному кэшу СУБД, и по другим частям системы (вплоть до сети, которой этот гигабайт приходилось гонять туда-сюда без всякой пользы).</p>
<p>В общем, знаете, что я думаю? Если результат запроса известен — наверное, его все-таки не нужно делать.</p>
            </div>
          </div>
          
        </article>


        
            

        <article class="rounded-2xl bg-white">

          <header class="space-y-2">

                        
            <header class="space-y-2">
            <a href="https://kostyanetsky.ru/notes/obsidian-foodiary"
                class="inline text-2xl font-semibold tracking-tight hover:underline">
                Фудиари для Обсидиана
            </a>
            </header>
            

            <div class="flex flex-wrap items-center gap-x-3 gap-y-2 text-sm text-slate-600">
              <span>14 апреля 2024</span>
              
                <span class="text-slate-300">·</span>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">Готово</span>
                </div>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">Typescript</span>
                </div>
                
                <div class="flex flex-wrap gap-2">
                    <span class="inline-flex items-center rounded-full border border-slate-200 bg-slate-50 px-2.5 py-1 text-xs text-slate-700">Obsidian</span>
                </div>
                
              
            </div>

          </header>

          <div class="mt-5">
            <div class="prose-like">
              <p>Вслед за <a href="https://kostyanetsky.ru/notes/obsidian-fastimer" target="_blank">первым</a> плагином для Obsidian пару недель назад выкатил <a href="https://github.com/vkostyanetsky/ObsidianFoodiary" target="_blank">второй</a>. Считает КБЖУ (калории, белки, жиры и углеводы) в пище. Помогает не переедать на пустом месте — всё-таки на глаз трудно оценить, сколько слопал за день, и можно ли позволить себе вон тот пончик.</p>
<p>Короче, полезная штука, если вы:</p>
<ol>
<li>Толстяк (как я)</li>
<li>Хотите перестать им быть (как я)</li>
<li>Ведете заметки в Obsidian (как я) 🙂</li>
</ol>
<p>На самом деле, программ для этой задачи полным-полно (я перепробовал штук десять). Остался недоволен: либо страшная, либо глючит, либо постоянно пытается всучить ежемесячную подписку. Короче, больше раздражает, чем помогает. Хочется чего-то нативного, встроенного в обычную рутину — и если она оседает в Obsidian, то решение напрашивается само собой.</p>
<p>Установить плагин можно прямо из программы — разработчики его уже одобрили. В остальном всё просто: пишем в ежедневной заметке, что съели и сколько это весило, и в ответ получаем компактную табличку с сортировкой по калориям и числам по белкам, жирам и углеводам. </p>
<p>В репозитории по ссылке выше есть примеры.</p>
            </div>
          </div>
          
        </article>


        
      </section>

      <section id="dynamicNotes" class="mt-10 hidden space-y-12"></section>

      <div
        id="empty"
        class="mt-8 hidden rounded-2xl border border-slate-200 bg-slate-50 p-8 text-center text-slate-700"
      >
        Ничего не нашлось. Попробуйте другой запрос?
      </div>

      <!-- Static pagination (works without JS; hide during search) -->
      <nav id="pagination" class="mt-10 flex items-center justify-between">
        
        <a
          id="prevLink"
          href="https://kostyanetsky.ru/notes/page-3"
          class="rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 transition hover:bg-slate-50"
        >
          ← Раньше
        </a>
        
        <span class="w-[1px]"></span>
        
        <a
          id="nextLink"
          href="https://kostyanetsky.ru/notes"
          class="rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 transition hover:bg-slate-50"
        >
          Дальше →
        </a>
        
      </nav>

<script>
  // ------------------------------------------------------------
  // Hybrid mode:
  // - Default: show static HTML notes (SEO-friendly, no-JS ok).
  // - On first user search OR tag click: fetch notes.json, hide static, render results.
  // - On clear (no query AND tag=all): show static again.
  // ------------------------------------------------------------

  const metaEl = document.getElementById("pageMeta");
  const notesJsonUrl = "https://kostyanetsky.ru/notes.json";

  const page = Number(metaEl.getAttribute("data-page") || "1");
  const totalPages = Number(metaEl.getAttribute("data-total-pages") || "1");
  const totalNotes = Number(metaEl.getAttribute("data-total-notes") || "0");

  const searchEl = document.getElementById("search");
  const countEl = document.getElementById("count");
  const pageInfoEl = document.getElementById("pageInfo");

  const staticNotesEl = document.getElementById("staticNotes");
  const dynamicNotesEl = document.getElementById("dynamicNotes");
  const emptyEl = document.getElementById("empty");
  const paginationEl = document.getElementById("pagination");

  let notesCache = null;
  let notesLoadPromise = null;

  // Tag filter state (chip)
  let activeTag = "all";

  const TAG_SESSION_KEY = "notesActiveTag";

  try {
    const saved = sessionStorage.getItem(TAG_SESSION_KEY);
    if (saved) activeTag = saved;
  } catch (e) {
    // no sessionStorage :|
  }

  const CHIP_CLASS_DEFAULT =
    "chip rounded-full border border-slate-200 bg-white px-3 py-1.5 text-xs text-slate-700 hover:bg-slate-50";
  const CHIP_CLASS_ACTIVE =
    "chip rounded-full border border-slate-200 bg-slate-100 px-3 py-1.5 text-xs text-slate-900 hover:bg-slate-200";

  function debounce(fn, ms = 200) {
    let t;
    return (...args) => {
      clearTimeout(t);
      t = setTimeout(() => fn(...args), ms);
    };
  }

  async function loadNotesJsonOnce() {
    if (notesCache) return notesCache;

    if (!notesLoadPromise) {
      notesLoadPromise = fetch(notesJsonUrl, { credentials: "same-origin" })
        .then((r) => {
          if (!r.ok) throw new Error(`Failed to load ${notesJsonUrl}: ${r.status}`);
          return r.json();
        })
        .then((data) => {
          // Expecting: [{ html: "<article>...</article>", text: "plain text", tags: ["work", ...] }, ...]
          notesCache = Array.isArray(data) ? data : [];
          return notesCache;
        })
        .catch((err) => {
          console.error(err);
          notesCache = [];
          return notesCache;
        });
    }

    return notesLoadPromise;
  }

  function showStaticMode() {
    dynamicNotesEl.classList.add("hidden");
    dynamicNotesEl.innerHTML = "";
    emptyEl.classList.add("hidden");

    staticNotesEl.classList.remove("hidden");
    paginationEl.classList.remove("hidden");

    countEl.textContent = String(totalNotes);
    pageInfoEl.textContent = `Страница ${page} из ${totalPages}`;
  }

  function showSearchMode() {
    staticNotesEl.classList.add("hidden");
    paginationEl.classList.add("hidden");

    dynamicNotesEl.classList.remove("hidden");
  }

  function normalizeTag(t) {
    return String(t || "")
      .trim()
      .toLowerCase();
  }

  function noteHasTag(note, tag) {
    if (!tag || tag === "all") return true;

    const want = normalizeTag(tag);

    const tags = note?.tags;
    
    return tags.map(normalizeTag).includes(want);
  }

  function filterNotes(notes, q, tag) {
    const needle = (q ?? "").trim().toLowerCase();
    const needText = needle.length > 0;
    const needTag = tag && tag !== "all";

    if (!needText && !needTag) return notes;

    return notes.filter((n) => {
      const matchesText = !needText ? true : String(n?.text ?? "").includes(needle);
      const matchesTag = !needTag ? true : noteHasTag(n, tag);
      return matchesText && matchesTag;
    });
  }

  function setActiveChipUI(tag) {
    document.querySelectorAll(".chip").forEach((x) => {
      x.className = CHIP_CLASS_DEFAULT;
      x.setAttribute("aria-pressed", "false");
    });

    const btn = Array.from(document.querySelectorAll(".chip")).find((b) => b.dataset.chip === tag);
    if (btn) {
      btn.className = CHIP_CLASS_ACTIVE;
      btn.setAttribute("aria-pressed", "true");
    }
  }

  function makeSearchLabel(q, tag) {
    const hasQ = (q || "").trim().length > 0;
    const hasTag = tag && tag !== "all";

    if (hasQ && hasTag) return `Поиск + #${normalizeTag(tag)}`;
    if (hasTag) return `Тег: #${normalizeTag(tag)}`;
    return "Поиск";
  }

  async function runSearch() {
    const q = (searchEl.value || "").trim();
    const hasQ = q.length > 0;
    const hasTag = activeTag && activeTag !== "all";

    if (!hasQ && !hasTag) {
      try { sessionStorage.removeItem(TAG_SESSION_KEY); } catch (e) {}
      showStaticMode();
      return;
    }

    showSearchMode();

    const notes = await loadNotesJsonOnce();
    const filtered = filterNotes(notes, q, activeTag);

    countEl.textContent = String(filtered.length);
    pageInfoEl.textContent = makeSearchLabel(q, activeTag);

    if (filtered.length === 0) {
      dynamicNotesEl.innerHTML = "";
      emptyEl.classList.remove("hidden");
      return;
    }

    emptyEl.classList.add("hidden");
    dynamicNotesEl.innerHTML = filtered.map((n) => n.html || "").join("\n");
  }

  // Initial render
  setActiveChipUI(activeTag);
  showStaticMode();

  // Text search handler
  searchEl.addEventListener("input", debounce(runSearch, 200));

  // Tag chips handler
  document.querySelectorAll(".chip").forEach((b) => {
    b.addEventListener("click", () => {
      activeTag = b.dataset.chip || "all";
        try {
        if (activeTag === "all") sessionStorage.removeItem(TAG_SESSION_KEY);
        else sessionStorage.setItem(TAG_SESSION_KEY, activeTag);
        } catch (e) {}      
      setActiveChipUI(activeTag);
      runSearch();
    });
  });

  // Search autorun in case search string is set (refresh / back-forward cache)
  function runSearchSoon() {
    requestAnimationFrame(() => requestAnimationFrame(() => runSearch()));
  }

  document.addEventListener("DOMContentLoaded", runSearchSoon);
  window.addEventListener("pageshow", runSearchSoon);
</script>



    </main>

    <!-- footer -->
    <footer class="mt-12 border-t border-slate-200">
      <div class="mx-auto w-full max-w-4xl px-4 py-8 text-sm text-slate-600">
        <div class="flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between">
          <p>Влад Костянецкий</p>
          <p>
            <a class="text-slate-900 underline decoration-slate-300 hover:decoration-slate-500" href="https://kostyanetsky.ru/rss.xml">RSS</a>
            <span class="mx-2 text-slate-300">·</span>
            <a class="text-slate-900 underline decoration-slate-300 hover:decoration-slate-500" href="https://github.com/vkostyanetsky">GitHub</a>
            <span class="mx-2 text-slate-300">·</span>
            <a class="text-slate-900 underline decoration-slate-300 hover:decoration-slate-500" href="https://t.me/tell_me_alisa">Telegram</a>            
          </p>
        </div>
      </div>
    </footer>

  </body>
</html>